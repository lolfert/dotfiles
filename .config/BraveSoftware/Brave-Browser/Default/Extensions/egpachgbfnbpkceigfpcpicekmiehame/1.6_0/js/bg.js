function toggleStatus(){var t=localStorage.pin_grid;localStorage.pin_grid="ON"==t?"OFF":"ON"}function getOption(t){var e=localStorage[t];return e?e:(console.log(t),localStorage[t]=defaults[t],localStorage[t])}function getHeight(){return getOption("pin_grid_height")-50}function checkUpdated(){return"OFF"==getOption("pin_grid_notify")&&(console.log("Notify Disabled: set last version!"),localStorage.pin_grid_version=LAST_VERSION),getOption("pin_grid_version")!=LAST_VERSION}var LAST_VERSION="1.6",defaults={pin_grid:"ON",pin_grid_fixed:"ON",pin_grid_height:"400",pin_grid_scroll:"ON",pin_grid_center:"ON",pin_grid_notify:"ON",pin_grid_desc:"ON",pin_grid_extra:"ON",pin_grid_version:"NONE"};if(chrome.runtime.onMessage.addListener(function(t,e,i){i("getHeight"==t.method?{status:getHeight()}:"activedExtra"==t.method?{status:"ON"==getOption("pin_grid_extra")}:{})}),chrome.tabs.onUpdated.addListener(function(t,e,i){if(i.url&&0!=i.url.match("[S]*.pinterest.com").length){var n="ON"==getOption("pin_grid"),r="ON"==getOption("pin_grid_fixed"),o=getHeight(),a="ON"==getOption("pin_grid_scroll"),s="ON"==getOption("pin_grid_center"),c="ON"==getOption("pin_grid_desc"),d="ON"==getOption("pin_grid_extra");"loading"==e.status?(n?(r&&(chrome.tabs.insertCSS(i.id,{file:"css/pinGrid.css",runAt:"document_start"}),chrome.tabs.insertCSS(i.id,{code:".pinWrapper, .UserNews, .SearchScopeSelector .gridItem, .FeedUsers .UserBase.gridItem { height: "+o+"px !important; }",runAt:"document_start"}),a&&chrome.tabs.insertCSS(i.id,{code:"@-webkit-keyframes slideAll { 0% { transform: translateY(-"+o+"px); top: "+o+"px; } 100% { transform: translateY(-100%); top: "+o+"px; } }",runAt:"document_start"}),s&&chrome.tabs.insertCSS(i.id,{code:".item.ext_smaller .Pin.summary .pinImageWrapper .pinImg { position: absolute; top: 0; bottom: 0; margin: auto; height: auto; }",runAt:"document_start"}),c&&chrome.tabs.insertCSS(i.id,{code:".Pin.summary .pinWrapper .pinMeta { transform: translateY(100%); } .Pin.summary .pinWrapper .pinMeta:hover { transform: translateY(0); } .Pin.summary .pinWrapper .pinMeta:after { display: block !important;}",runAt:"document_start"})),d&&chrome.tabs.insertCSS(i.id,{file:"css/extraDownload.css",runAt:"document_start"}),chrome.pageAction.setIcon({tabId:t,path:"img/iconON.png"}),chrome.pageAction.setTitle({tabId:t,title:chrome.i18n.getMessage("ON")})):(chrome.pageAction.setIcon({tabId:t,path:"img/iconOFF.png"}),chrome.pageAction.setTitle({tabId:t,title:chrome.i18n.getMessage("OFF")})),chrome.pageAction.show(t)):"complete"==e.status&&(window.addEventListener("storage",function(t){chrome.tabs.reload(i.id)},!0),n&&chrome.tabs.executeScript(i.id,{file:"js/inject.js",runAt:"document_start"}))}}),chrome.pageAction.onClicked.addListener(function(t){"ON"==getOption("pin_grid")?chrome.tabs.create({url:"options.html"}):(toggleStatus(),chrome.tabs.reload(t.id))}),checkUpdated()){var notifyOption={type:"basic",iconUrl:"img/icon.png",title:"Pinterest Enhanced Updated - "+LAST_VERSION,message:"New version of Pinterest Enhanced installed. ",buttons:[{title:"See what's new!"},{title:"Discard"}],isClickable:!1};chrome.notifications.create("",notifyOption,function(t){}),chrome.notifications.onButtonClicked.addListener(function(t,e){0==e&&(chrome.tabs.create({url:"options.html#changelog"}),localStorage.pin_grid_version=LAST_VERSION),chrome.notifications.clear(t,function(t){}),localStorage.pin_grid_version=LAST_VERSION})}